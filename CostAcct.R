require(car)
require(gplots)
require(effects)
Returns <<- structure(list(Date = structure(c(16344, 16375, 16405, 16436, 
16467, 16495, 16526, 16556, 16587, 16617, 16648, 16679, 16709, 
16740, 16770, 16801, 16832, 16861, 16892, 16922, 16953, 16983, 
17014, 17045, 17075, 17106, 17136, 17167, 17198, 17226, 17257, 
17287, 17318, 17348, 17379, 17410, 17440), class = "Date"), GSPC = c(0.0232014607867722, 
0.0245335887603648, -0.00418858787792041, -0.0310408057904702, 
0.054892511014554, -0.0173961069137562, 0.00852081973012474, 
0.0104913823933169, -0.0210116723759005, 0.0197420296967213, 
-0.0625808181672028, -0.0264428315732271, 0.0829831177603941, 
0.000504869260724018, -0.0175301851763144, -0.0507353219729464, 
-0.00412836043029912, 0.0659911145773651, 0.00269939848087326, 
0.0153246023575726, 0.000910921120978111, 0.0356098011252543, 
-0.00121924313604803, -0.00123445084432539, -0.0194256792795575, 
0.0341745221875705, 0.0182007621968952, 0.0178843581714646, 0.0371981603372791, 
-0.00038919718808454, 0.00909120854931821, 0.0115762513913414, 
0.00481377509085544, 0.0193488261180306, 0.000546432811085681, 
0.0193029785332437, 0.0221682695716353), ABT = c(0.0480884365754519, 
0.0265305044498156, 0.0114582477964826, -0.00577513758465697, 
0.0639131329535274, -0.0219547858810809, 0.00194239705098986, 
0.052319061542057, 0.00987663660445464, 0.0328033432386433, -0.095276331408542, 
-0.118755392690756, 0.113873717323979, 0.00850070094598036, -0.000222424198183451, 
-0.157203407021522, 0.0299731971959069, 0.0797623801505915, -0.07004528743627, 
0.0249896747123744, -0.00807465877106126, 0.138387150990661, 
-0.0552216409450678, 0.00642541014746128, -0.0721209358746512, 
-0.0236491420008403, 0.00893089459267916, 0.0874772693604793, 
0.0862147344434518, -0.0148624877267698, -0.0173384843667056, 
0.0526875332592726, 0.0646080532067337, 0.011725949017434, 0.0415190256145656, 
0.0475069101584319, 0.0509745169223096), PFE = c(0.0128509793317065, 
0.0400666622646756, 0.00866076766137422, 0.00321031362630154, 
0.0982400484215817, 0.0226373397828456, -0.0247197108324137, 
0.0241672561002626, -0.0271243322177411, 0.0754549712812248, 
-0.077648543288769, -0.0482423029598669, 0.0767270974994809, 
-0.0310465994653247, -0.00700191978364903, -0.0554523210608898, 
-0.0268940076217515, 0.00903222831435001, 0.103576266598288, 
0.0608378474079667, 0.0237841134133271, 0.0477136866026243, -0.0566549421675282, 
-0.0186338024535317, -0.0637731635892443, 0.0135604664889172, 
-0.00385317685701487, 0.000946267411239159, 0.0753229904838527, 
0.0128525295653307, -0.00847709962987426, -0.0374408473259866, 
0.0387480538539166, -0.0128013582057141, 0.0229191455364996, 
0.0627570841316291, 0.0196078705992193), EXPD = c(0.0512566299241186, 
0.0975154128171488, -0.0404461678811103, -0.0208473282396495, 
0.105769167836614, -0.00248451683451559, -0.0487754024596815, 
0.000218237540300182, 0.0136575189730664, 0.0164823527213951, 
0.0448047152121789, -0.0392076703408892, 0.0650372385123013, 
-0.0205548434154766, -0.0743146375083185, 0.000443480881003588, 
0.0146276099863547, 0.0661861456125536, 0.0163901380045911, -0.0213667230228493, 
0.0184216506172721, 0.00795269244046845, 0.0246813968017255, 
0.0171766669810322, -0.000970443915645877, 0.0246745218508603, 
0.0118353717879499, -0.0166162602338134, 0.0825652142810801, 
0.00195110943235045, -0.00708098458575411, -0.0483151865397221, 
0.0665339491559775, -0.00531161473087814, -0.00142402990388039, 
0.0670232287708816, -0.0157033575726134)), .Names = c("Date", 
"GSPC", "ABT", "PFE", "EXPD"), row.names = c(NA, -37L), class = c("tbl_df", 
"tbl", "data.frame"))
HMB <<- structure(list(units = c(268, 279, 430, 141, 412, 574, 456, 196, 386, 258, 450, 316, 352, 292, 263, 525, 143, 267, 326, 460, 580, 566, 176, 209, 400, 447, 360, 189, 151, 471, 405, 506, 376, 269, 483, 434, 173, 217, 231, 174, 186, 290, 206, 172, 470, 159, 544, 428, 438, 490, 245, 546, 554, 398, 349, 332, 393, 296, 517, 494), TotCost = c(19624.30773, 16790.41492, 21489.10677, 15998.02674, 23771.94567, 24365.4756, 23724.83788, 16928.97483, 20738.20892, 17747.66292, 21480.21451, 17559.58997, 19731.90741, 19295.2005, 17828.957, 24175.42698, 14357.98395, 18524.81363, 20087.48175, 22301.03134, 24627.96587, 23409.5391, 15309.48682, 16182.97191, 20755.60117, 22430.95432, 19190.33155, 18167.35708, 15246.06305, 21328.64645, 20245.94196, 23880.93212, 20126.65678, 18376.04508, 23284.72698, 21969.43476, 14994.43448, 15726.92079, 16424.78712, 17410.3598, 17605.20581, 19545.99434, 15300.08244, 17178.10077, 22409.95135, 15485.60432, 24240.0031, 20774.9159, 21635.60254, 22734.84517, 18000.14228, 24441.09039, 24887.82916, 20616.76379, 20561.77933, 19694.49895, 20060.38617, 18999.21016, 23251.12337, 23778.02921)), .Names = c("units", "TotCost"), row.names = c(NA, -60L), class = "data.frame")
ScarceSteady <<- structure(list(TotCost2 = c(14407.20535, 15202.62491, 20861.82254, 
11930.79563, 21247.85311, 31464.42433, 23660.63054, 10315.74457, 
20502.74715, 14069.57579, 25847.35297, 17320.16444, 19370.14845, 
14424.53285, 13198.87612, 28367.85079, 11953.7473, 13757.31071, 
15341.68092, 24343.3603, 33502.47715, 31080.37466, 12582.01091, 
11494.08377, 20603.64447, 23242.17997, 19814.04368, 11778.93725, 
9735.186376, 22854.24385, 21253.82141, 26980.33912, 19435.04096, 
13334.1828, 23795.2125, 22697.12656, 12075.52953, 12973.07947, 
15397.29416, 11588.44313, 14004.27674, 16515.11304, 14057.9828, 
12839.11297, 23737.90259, 12226.25796, 27935.05023, 21297.8698, 
22117.03943, 27301.66011, 13881.78796, 28499.48041, 29577.17647, 
18785.52121, 19617.04907, 16807.15224, 19674.45524, 16144.39521, 
28826.93464, 25784.44198), units = c(268, 279, 430, 141, 412, 
574, 456, 196, 386, 258, 450, 316, 352, 292, 263, 525, 143, 267, 
326, 460, 580, 566, 176, 209, 400, 447, 360, 189, 151, 471, 405, 
506, 376, 269, 483, 434, 173, 217, 231, 174, 186, 290, 206, 172, 
470, 159, 544, 428, 438, 490, 245, 546, 554, 398, 349, 332, 393, 
296, 517, 494)), .Names = c("TotCost2", "units"), row.names = c(NA, 
-60L), class = "data.frame")
Semiconductors <<- structure(list(TotCost4 = c(41330.4109927789, 42697.3314907496, 
49937.7077840076, 29498.0616966149, 50963.4614339071, 56646.9309663364, 
52050.6355895573, 33857.2770187725, 49392.1054359784, 39855.8491333539, 
52056.4965463609, 44968.5266430372, 46572.913952329, 45119.9490823297, 
40080.2186893259, 54708.8409556411, 27400.3528294927, 39963.293401106, 
46473.0191765721, 51957.2755465477, 54402.847721223, 56334.0662109463, 
35247.0361152296, 35994.4039987992, 50297.954402137, 53628.0412895762, 
50095.1651395488, 34565.5667646373, 33376.973363763, 54527.2764921765, 
49757.4137954573, 55760.1684766004, 46007.5285119332, 42855.2361039463, 
57518.268991442, 52144.2370536137, 34917.2949016818, 40705.0761286098, 
40030.0649343554, 35250.8781784691, 34721.046996235, 38536.2016564443, 
37182.1142815998, 30737.499589725, 51856.9701359246, 31672.204295237, 
52395.7733296662, 51859.023152378, 52080.1657843357, 52611.6018126938, 
39759.906497891, 54837.9807990567, 62861.9736790228, 49727.473373954, 
45459.6674878623, 47924.5887144352, 50984.7789396965, 42190.6307409558, 
57336.3133850532, 56854.6154905962), units = c(268, 279, 430, 
141, 412, 574, 456, 196, 386, 258, 450, 316, 352, 292, 263, 525, 
143, 267, 326, 460, 580, 566, 176, 209, 400, 447, 360, 189, 151, 
471, 405, 506, 376, 269, 483, 434, 173, 217, 231, 174, 186, 290, 
206, 172, 470, 159, 544, 428, 438, 490, 245, 546, 554, 398, 349, 
332, 393, 296, 517, 494)), .Names = c("TotCost4", "units"), row.names = c(NA, 
-60L), class = "data.frame")

PowerPlant <<- structure(list(TotCost3 = c(24416.5897779455, 20605.3114335502, 
30714.7472031185, 21578.0043966965, 27827.2125319325, 48150.5951024319, 
36495.6806023703, 20866.2648969924, 28859.1348175718, 28399.6692193766, 
40560.4381284271, 25954.791654815, 27939.6094017339, 26281.8089816931, 
24376.028771475, 43563.662292907, 15922.4243225429, 21914.5014289569, 
29943.4065179429, 41513.781209007, 46392.7242450058, 52204.704677507, 
21028.7319719515, 18695.5974921709, 28263.8829299904, 29269.0419596408, 
32054.0208014099, 16050.0547272057, 18838.6439044363, 40539.3711760595, 
29252.1928197789, 40099.887253739, 28859.2235833453, 23529.8055961624, 
39874.3507000095, 34571.6442428862, 14209.5076496738, 17574.69887011, 
22107.0604269855, 15474.9886507092, 23233.1535854568, 27513.2426144655, 
14203.5267845138, 20107.5168361151, 42105.8356417359, 19678.7467433944, 
44108.1839111289, 33360.3830479584, 35238.5744622984, 41105.7100381097, 
23002.381015203, 41456.7546275362, 45401.7721915859, 29655.8117606004, 
28987.4140084783, 23987.4508118372, 32495.4901301905, 26072.9174029607, 
43134.2922278337, 42633.0992597848), Plant3 = c(0, 0, 0, 0, 0, 
1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 
0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 
0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1), Plant2 = c(1, 1, 1, 0, 
1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 
1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 
1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1), units = c(268, 279, 
430, 141, 412, 574, 456, 196, 386, 258, 450, 316, 352, 292, 263, 
525, 143, 267, 326, 460, 580, 566, 176, 209, 400, 447, 360, 189, 
151, 471, 405, 506, 376, 269, 483, 434, 173, 217, 231, 174, 186, 
290, 206, 172, 470, 159, 544, 428, 438, 490, 245, 546, 554, 398, 
349, 332, 393, 296, 517, 494), PlantFac = structure(c(2L, 2L, 
2L, 1L, 2L, 3L, 3L, 1L, 2L, 2L, 3L, 2L, 2L, 2L, 2L, 3L, 1L, 2L, 
2L, 3L, 3L, 3L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 3L, 2L, 3L, 2L, 2L, 
3L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 3L, 1L, 3L, 2L, 2L, 3L, 
1L, 3L, 3L, 2L, 2L, 2L, 2L, 2L, 3L, 3L), .Label = c("0", "1", 
"2"), class = "factor")), .Names = c("TotCost3", "Plant3", "Plant2",
"units", "PlantFac"), row.names = c(NA, -60L), class = "data.frame") 
black.box.maker <- function(mod1) {
            d1 <- dim(mod1$model)[[1]]
            sumsq1 <- var(mod1$model[,1], na.rm=TRUE)*(d1-1)
            rt1 <- sqrt(sumsq1)
            sumsq2 <- var(mod1$fitted.values, na.rm=TRUE)*(d1-1)
            rsquare <- round(sumsq2/sumsq1, digits=4)
            rt2 <- sqrt(sumsq2)
            plot(x=NA, y=NA, xlim=c(0,rt1), ylim=c(0,rt1), main=paste("R-squared:",rsquare), xlab="", ylab="", bty="n", cex=0.5)
            polygon(x=c(0,0,rt1,rt1), y=c(0,rt1,rt1,0), col="black")
            polygon(x=c(0,0,rt2,rt2), y=c(0,rt2,rt2,0), col="green")
            }
